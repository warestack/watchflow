rules:
  # Essential Open Source Rules
  - description: "Pull requests must have descriptive titles following conventional commit format"
    enabled: true
    severity: "medium"
    event_types: ["pull_request"]
    parameters:
      title_pattern: "^feat|^fix|^docs|^style|^refactor|^test|^chore|^perf|^ci|^build|^revert"

  - description: "New contributors require approval from at least one past contributor"
    enabled: true
    severity: "medium"
    event_types: ["pull_request"]
    parameters:
      min_past_contributors: 1

  - description: "Code changes must include corresponding tests"
    enabled: true
    severity: "medium"
    event_types: ["pull_request"]
    parameters:
      pattern: "tests/.*\\.py$|test_.*\\.py$"
      condition_type: "files_match_pattern"

  - description: "Changes to critical files require review from code owners"
    enabled: true
    severity: "high"
    event_types: ["pull_request"]

  - description: "No direct pushes to main branch - all changes must go through PRs"
    enabled: true
    severity: "critical"
    event_types: ["push"]
    parameters:
      allow_force_push: false

# Enhanced validation schema for .watchflow/rules.yaml
validation:
  input_sanitization:
    enabled: true
    max_comment_length: 1000
    allowed_characters: "alphanumeric, basic punctuation"
    blocked_patterns: ["<script>", "javascript:", "data:"]
  
  rule_validation:
    enabled: true
    max_rules_per_repo: 50
    max_rule_complexity: 100
    required_fields: ["id", "name", "description", "enabled"]
